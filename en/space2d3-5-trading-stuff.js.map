{
  "version": 3,
  "sources": ["src/const.ts", "src/saveableType.ts", "src/components.ts", "src/draw.ts", "src/gameState.ts", "src/cargo.ts", "src/utils.ts", "src/ship.ts", "src/playerShip.ts", "src/walker.ts", "src/walkManager.ts", "src/geometry.ts", "src/planets.ts", "src/stars.ts", "src/index.ts"],
  "sourcesContent": ["export const shipBaseSpeed = 0.1\nexport const planet_size = 0.2\nexport const cargoPerCargoBay = 4\nexport const shipNames = [\"Beast of Burden\", \"Blade of Occam\", \"Lance of Centri\", \"Wasp\", \"Stophy's Venture\", \"Enterprise\", \"Sally Ride\", \"Stellar Explorer\", \"First Light\", \"Lance of Zhargi\", \"Adventurer of Bacia\", \"Astral Enterprise\", \"Star of Kali\", \"Isaur Gypsy\", \"Astral Pioneer\", \"Celestial Maiden\", \"Luna Moth\", \"Harrier\", \"Fralphua's Opportunity\", \"Tory's Venture\", \"Star of Kini\", \"Flame of Rasi\", \"Bolo\", \"Edwin Hubble\", \"Ycon Express\", \"Wren\", \"Spirit of Taly\", \"Illustrious\", \"Yukon\", \"Bara Traveler\", \"Horizon\", \"Star of Icon\", \"Lady of Ghera\", \"Celestial Jewel\", \"Youthful Indiscretion\", \"Gauntlet of Anic\", \"Shoole Trader\", \"Bake Clipper\", \"Jewel of Jocia\", \"Solar Constellation\", \"Uctim Clipper\", \"Castle of Syko\", \"Stellar Jewel\", \"Profit Margin\", \"Irregular of Taly\", \"Swallow\", \"Pathfinder\", \"Celestial Destiny\", \"Spirit of Inquiry\"];\n// export const shipColors = [\"000000\", \"2f4f4f\", \"556b2f\", \"8b4513\", \"8b0000\", \"808000\", \"483d8b\", \"5f9ea0\", \"008000\", \"3cb371\", \"4682b4\", \"d2691e\", \"9acd32\", \"cd5c5c\", \"00008b\", \"32cd32\", \"daa520\", \"8fbc8f\", \"800080\", \"b03060\", \"ff0000\", \"00ced1\", \"ff8c00\", \"ffd700\", \"ffff00\", \"0000cd\", \"deb887\", \"00ff00\", \"00fa9a\", \"8a2be2\", \"dc143c\", \"00bfff\", \"adff2f\", \"ff6347\", \"da70d6\", \"b0c4de\", \"ff00ff\", \"f0e68c\", \"6495ed\", \"dda0dd\", \"ff1493\", \"7b68ee\", \"ffa07a\", \"afeeee\", \"98fb98\", \"7fffd4\", \"fafad2\", \"ff69b4\", \"ffb6c1\", \"fff0f5\"];\nexport const shipColors = ['black', 'darkslategray', 'darkolivegreen', 'saddlebrown', 'darkred', 'olive', 'darkslateblue', 'cadetblue', 'green', 'mediumseagreen', 'steelblue', 'chocolate', 'yellowgreen', 'indianred', 'darkblue', 'limegreen', 'goldenrod', 'darkseagreen', 'purple', 'maroon3', 'red', 'darkturquoise', 'darkorange', 'gold', 'yellow', 'mediumblue', 'burlywood', 'lime', 'mediumspringgreen', 'blueviolet', 'crimson', 'deepskyblue', 'greenyellow', 'tomato', 'orchid', 'lightsteelblue', 'fuchsia', 'khaki', 'cornflower', 'plum', 'deeppink', 'mediumslateblue', 'lightsalmon', 'paleturquoise', 'palegreen', 'aquamarine', 'lightgoldenrod', 'hotpink', 'lightpink', 'lavenderblush']\n", "export abstract class SaveableObject {\n    static id: string\n\n    get mytype() { return this.constructor as typeof SaveableObject }\n    get typename(): string { return this.mytype.id }\n\n    toJSON() {\n        return { 'type': this.typename }\n    }\n    static fromJSON(type: typeof SaveableObject, data: object) {\n        // same as `return new type()`\n        return new (type as unknown as new () => SaveableObject)()\n    }\n}\n\nexport function fromJSON(data: { 'type': string }) {\n    const type = types[data.type]\n    return type.fromJSON(type, data)\n}\n\n\nexport var types: { [key: string]: typeof SaveableObject } = {}\n\nexport function addType(type: typeof SaveableObject, id: string) {\n    types[id] = type\n    type.id = id\n}\n", "import { Cargo, ResourceCargo } from \"./cargo\"\nimport { planet_size, shipBaseSpeed } from \"./const\"\nimport { draw_planet, draw_ships, draw_star, showDate } from \"./draw\"\nimport { GameState, gs } from \"./gameState\"\nimport { gebi } from \"./index\"\nimport { Planet } from \"./planets\"\nimport { PlayerShip } from \"./playerShip\"\nimport { SaveableObject, addType, fromJSON } from \"./saveableType\"\nimport { Ship } from \"./ship\"\n\nexport abstract class Component extends SaveableObject {\n    cellName? = ''\n    ship: Ship\n    onEnter(gs: GameState) { }\n}\nexport function isComponentType(type: typeof SaveableObject): type is typeof Component { return type.prototype instanceof Component };\n\nexport abstract class UselessComponent extends Component { }\n\nexport class Airlock extends UselessComponent {\n    onEnter(gs: GameState) {\n        gebi('Airlock_Locked').style.display = (gs.playerShip.toPlanet == gs.playerShip.onPlanet) ? '' : 'none';\n        gebi('Airlock_UnLocked').style.display = (gs.playerShip.toPlanet == gs.playerShip.onPlanet) ? 'none' : '';\n        gebi('Airlock_Detach').onclick = () => { gs.depart() };\n    }\n}\naddType(Airlock, 'Airlock')\n\nexport class Passage extends UselessComponent { }\naddType(Passage, 'Passage')\n\nexport class Ballast extends UselessComponent {\n    opposite? = ''\n    onEnter(gs) {\n        (document.querySelector('#Ballast b') as HTMLElement).innerText = this.opposite || ''\n    }\n}\naddType(Ballast, 'Ballast')\n\nexport class Debris extends UselessComponent {\n    original: string = ''\n    toJSON() {\n        return {\n            'type': this.typename,\n            'original': this.original\n        }\n    }\n    static fromJSON(type: typeof SaveableObject, data: { original: string }) {\n        let a = new Debris()\n        a.original = data.original\n        return a\n    }\n}\naddType(Debris, 'Debris')\n\n\n\nexport abstract class NormalComponent extends Component { }\n\nexport class CargoBay extends NormalComponent {\n    cargo: Array<Cargo> = []\n    toJSON() {\n        return {\n            'type': this.typename,\n            'cargo': this.cargo.map(x => x.toJSON())\n        };\n    }\n    static fromJSON(type: typeof SaveableObject, data: { cargo: Array<{ 'type': string }> }) {\n        let a = new CargoBay();\n        a.cargo = data.cargo.map((x: { type: string }) => fromJSON(x));\n        return a;\n    }\n    onEnter(gs: GameState) {\n        (document.querySelector('#CargoBay ul') as HTMLUListElement).innerHTML = this.cargo.map(x => `<li>${x.typename}</li>`).join('');\n        (document.getElementById('CargoBay_Empty') as HTMLDivElement).style.display = (this.cargo.length == 0) ? '' : 'none';\n        (document.getElementById('CargoBay_NonEmpty') as HTMLDivElement).style.display = (this.cargo.length == 0) ? 'none' : '';\n    }\n}\naddType(CargoBay, 'CargoBay');\nexport function isCargoBay(component: Component): component is CargoBay { return component instanceof CargoBay };\n\n\n\nexport class Radar extends NormalComponent {\n    onEnter(gs: GameState) {\n        const c = document.querySelector('#Radar canvas') as HTMLCanvasElement\n        const ctx = c.getContext(\"2d\") as CanvasRenderingContext2D;\n        drawRadar();\n    }\n}\naddType(Radar, 'Radar');\n\nfunction drawRadar(ts?: number) {\n    const c = document.querySelector('#Radar canvas') as HTMLCanvasElement\n    if (c.offsetParent === null) return;\n    const ctx = c.getContext(\"2d\") as CanvasRenderingContext2D;\n    if (gs.tick(ts)) window.requestAnimationFrame(drawRadar);\n    // TODO: draw planets only once, and redraw only ships\n    // (maybe on another canvas)\n    draw_star(ctx, gs.star);\n    draw_ships(ctx, gs.star.ships, gs.playerShip.componentTypes[Radar.id]);\n}\n\nexport class Cloak extends NormalComponent { }\naddType(Cloak, 'Cloak');\n\nexport abstract class EngineComponent extends NormalComponent { }\n\nexport abstract class ComputerComponent extends NormalComponent { }\n\nexport class NavigationComputer extends ComputerComponent {\n    planetTr(value: { planet: Planet; i: number }) {\n        const planet = value.planet;\n        const i = value.i;\n        if (planet == gs.playerShip.onPlanet) return '';\n        const time = Math.ceil(planet.distanceTo(gs.playerShip) / shipBaseSpeed);\n        const selected = (planet == gs.playerShip.toPlanet) ? 'checked' : '';\n        return `<tr><td>\n            <label for=\"NavigationComputer_to_${i}\"><canvas id=\"NavigationComputer_canvas_${i}\" width=30 height=30></canvas></label>\n        </td><td>\n            <label><input type=\"radio\" name=\"NavigationComputer_to\" value=\"${i}\" id=\"NavigationComputer_to_${i}\" ${selected}>\n            <b>${planet.name}</b> (${time}d)<br>\n            ${planet.buys ? `wants: ${planet.buys.id}` : ''} ${planet.sells ? `gives: ${planet.sells.id}` : ''}\n        </label></td></tr>`\n    }\n    showDiv(id: string) {\n        gebi('currentComponentPage').innerHTML = `#NavigationComputer_${id}{display:block !important}`;\n    }\n    onEnter(gs: GameState) {\n        if (gs.timeFlies) {\n            this.showDiv('Flying');\n            return;\n        }\n        this.showDiv('Select');\n        (document.querySelector('#NavigationComputer table') as HTMLTableElement).innerHTML =\n            gs.star.planets.map((p, i) => { return { 'planet': p, 'i': i, 'dist': p.distanceTo(gs.playerShip) } }).sort((a, b) => a.dist - b.dist).map(this.planetTr).join('');\n        gs.star.planets.forEach((planet, i) => {\n            const c = document.getElementById(`NavigationComputer_canvas_${i}`) as HTMLCanvasElement;\n            if (!c) return;\n            const ctx = c.getContext(\"2d\") as CanvasRenderingContext2D;\n            draw_planet(ctx, planet, c.width / planet_size / 2, c.width / 2, c.height / 2);\n        })\n        gebi('NavigationComputer_Plot').style.display = (this.ship instanceof PlayerShip) ? 'none' : '';\n        gebi('NavigationComputer_Fly').style.display = (this.ship instanceof PlayerShip) ? '' : 'none';\n        gebi('NavigationComputer_Plot').onclick = () => {\n            const el = document.querySelector('input[name=\"NavigationComputer_to\"]:checked') as HTMLInputElement;\n            if (!el) return false;\n            if (!gs.playerShip.onPlanet) return false;\n            gs.playerShip.planTrip(gs.playerShip.onPlanet, gs.star.planets[parseInt(el.value)], gs.now);\n            this.showDiv('Detach');\n            // console.log('NavigationComputer_Plot', gs.playerShip.toPlanet, gs.star.planets, parseInt(el.value));\n            return true;\n        }\n        gebi('NavigationComputer_Fly').onclick = () => {\n            if (!gebi('NavigationComputer_Plot').onclick()) return false;\n            this.showDiv('Departed');\n            gs.depart();\n        }\n    }\n}\naddType(NavigationComputer, 'NavigationComputer');\n\n\n\nexport class TradingComputer extends ComputerComponent {\n    showDiv(id: string) {\n        gebi('currentComponentPage').innerHTML = `#TradingComputer_${id}{display:block !important}`;\n    }\n    onEnter(gs: GameState): void {\n        const planet = gs.playerShip.onPlanet as Planet;\n        if (planet === null) {\n            this.showDiv('None');\n            return;\n        }\n        gs.playerShip.countCargo();\n        if (planet.buys === null) {\n            // FREE GIFT\n            const giftAmount = Math.min(gs.playerShip.freeCargo, planet.ratio);\n            if (giftAmount == 0) {\n                this.showDiv('NoGift');\n                return;\n            }\n            this.showDiv('Gift');\n            gebi('TradingComputer_gift_number').innerText = giftAmount.toString();\n            gebi('TradingComputer_gift_type').innerText = planet.sells.id;\n            gebi('TradingComputer_gift_take').onclick = () => {\n                gs.playerShip.putCargo((planet).sells, giftAmount);\n                this.showDiv('Done');\n            };\n            return;\n        }\n        // rest is for normal trade\n        if (gs.playerShip.cargoTypes[planet.buys.id] < 1) {\n            this.showDiv('NothingToTradde');\n            return;\n        }\n        this.showDiv('Trade');\n        const slider = gebi('TradingComputer_give_slider') as HTMLInputElement;\n        gebi('TradingComputer_give_type').innerText = planet.buys.id;\n        gebi('TradingComputer_get_type').innerText = planet.sells.id;\n        slider.max = slider.value = gs.playerShip.cargoTypes[planet.buys.id].toString();\n        slider.style.display = gs.playerShip.cargoTypes[planet.buys.id] == 1 ? 'none' : '';\n        slider.onchange = () => {\n            const giveAmount = parseInt(slider.value);\n            let getAmount = Math.round(giveAmount * planet.ratio);\n            gebi('TradingComputer_max_cargo_warning').style.display = (getAmount - giveAmount > gs.playerShip.freeCargo) ? '' : 'none';\n            getAmount = Math.min(getAmount, gs.playerShip.freeCargo + giveAmount);\n            gebi('TradingComputer_give_number').innerText = giveAmount.toString();\n            gebi('TradingComputer_get_number').innerText = getAmount.toString();\n        };\n        slider.onchange();\n        gebi('TradingComputer_deal').onclick = () => {\n            const giveAmount = parseInt(slider.value);\n            let getAmount = Math.round(giveAmount * planet.ratio);\n            getAmount = Math.min(getAmount, gs.playerShip.freeCargo + giveAmount);\n            // console.log('before', gs.playerShip.cargoTypes, gs.playerShip.freeCargo);\n            // console.log(giveAmount, planet.buys, getAmount, planet.sells);\n            gs.playerShip.getCargo(planet.buys as typeof ResourceCargo, giveAmount);\n            gs.playerShip.putCargo(planet.sells as typeof ResourceCargo, getAmount);\n            // console.log('after', gs.playerShip.cargoTypes, gs.playerShip.freeCargo);\n            this.showDiv('Done');\n        };\n    }\n\n}\naddType(TradingComputer, 'TradingComputer');", "import { Airlock, Cloak, Component, ComputerComponent, Passage } from \"./components\"\nimport { WalkMap } from \"./walker\";\nimport { Ship, xywh } from \"./ship\";\nimport { Planet } from \"./planets\";\nimport { Star } from \"./stars\";\nimport { planet_size } from \"./const\";\nimport { gebi } from \"./index\";\nimport { gs } from \"./gameState\";\nimport { PlayerShip } from \"./playerShip\";\n\nexport const componentSize = 50\nexport const componentOffset = 5\n\nfunction drawComponent(ctx: CanvasRenderingContext2D, x: number, y: number, ship: Ship, component: Component, map?: WalkMap) {\n    if (ship.isAlien) {\n        ctx.rect(x * componentSize, y * componentSize + componentOffset, componentSize, componentSize - 2 * componentOffset);\n    } else {\n        ctx.rect(x * componentSize + componentOffset, y * componentSize, componentSize - 2 * componentOffset, componentSize);\n    }\n    ctx.strokeStyle = \"white\";\n    ctx.fillStyle = \"white\";\n    ctx.stroke();\n    ctx.textBaseline = 'top';\n    ctx.fillText(component.cellName || '', x * componentSize + componentOffset, y * componentSize)\n    let componentTitle = component.typename[0];\n    if (component instanceof ComputerComponent) componentTitle += 'C';\n    if (component instanceof Cloak) componentTitle += 'l';\n    ctx.fillText(componentTitle, x * componentSize + componentOffset, y * componentSize + 16);\n    if (map) {\n        map.map[x][y].canBeHere = true\n        map.map[x][y].canGoX = ship.isAlien\n        map.map[x][y].canGoY = !ship.isAlien\n        map.map[x][y].ship = ship\n        map.map[x][y].component = component\n    }\n}\n\nfunction drawPassage(ctx: CanvasRenderingContext2D, x0: number, y0: number, ship: Ship, map?: WalkMap) {\n    const p = ship.passage\n    ctx.rect((x0 + p.x) * componentSize, (y0 + p.y) * componentSize, p.w * componentSize, p.h * componentSize);\n    ctx.strokeStyle = \"white\";\n    ctx.fillStyle = \"white\";\n    ctx.stroke();\n    ctx.textBaseline = 'top';\n    if (map) {\n        let component = new Passage();\n        for (let x = 0; x < p.w; x++)\n            for (let y = 0; y < p.h; y++) {\n                map.map[x + x0][y + y0].canBeHere = true\n                map.map[x + x0][y + y0].canGoX = true\n                map.map[x + x0][y + y0].canGoY = true\n                map.map[x + x0][y + y0].ship = ship\n                map.map[x + x0][y + y0].component = component\n            }\n    }\n}\n\nexport function drawAirlock(ctx: CanvasRenderingContext2D, x: number, y: number, map?: WalkMap) {\n    // NOTE: YOUR ship is always the lower one\n    // TODO: this is for normal-to-normal ship. How it will look with alien ships - TBD\n    ctx.strokeStyle = \"white\";\n    ctx.strokeStyle = \"white\";\n    ctx.fillStyle = \"white\";\n    ctx.beginPath();\n    ctx.moveTo(x * componentSize + componentOffset, y * componentSize);\n    ctx.lineTo(x * componentSize + componentOffset * 2, (y + 0.5) * componentSize);\n    ctx.lineTo(x * componentSize + componentOffset, (y + 1) * componentSize);\n    ctx.lineTo((x + 1) * componentSize - componentOffset, (y + 1) * componentSize);\n    ctx.lineTo((x + 1) * componentSize - componentOffset * 2, (y + 0.5) * componentSize);\n    ctx.lineTo((x + 1) * componentSize - componentOffset, y * componentSize);\n    ctx.closePath();\n    ctx.stroke();\n\n    if (map) {\n        map.map[x][y].canBeHere = true\n        map.map[x][y].canGoY = true\n        map.map[x][y].component = new Airlock()\n    }\n}\n\nexport function drawShip(ctx: CanvasRenderingContext2D, x0, y0, ship: Ship, map?: WalkMap) {\n    // draw ship INTERIOR\n    for (let row = 0; row < ship.rows.length; row++) {\n        for (let i = 0; i < ship.rows[row].length; i++) {\n            let component = ship.rows[row][i];\n            let xy = ship.rowToXY(row, i);\n            component.cellName = String.fromCharCode(65 + row) + xy.y;\n            drawComponent(ctx, x0 + xy.x, y0 - xy.y, ship, component, map);\n        }\n    }\n    drawPassage(ctx, x0, y0, ship, map);\n}\n\nexport function draw_ship(ctx: CanvasRenderingContext2D, ship: Ship, cell_size: number) {\n    // draw ship ON STAR MAP\n    const x = (ship.x) * cell_size;\n    const y = (ship.y) * cell_size;\n    // console.log('draw', ship.color, x, y);\n    ctx.fillStyle = ship.color;\n    ctx.fillRect(x - 1, y - 1, 3, 3);\n    if (ship instanceof PlayerShip) {\n        for (let r = 1; r <= ship.componentTypes['Radar']; r++) {\n            ctx.beginPath();\n            ctx.arc(x, y, cell_size * r, 0, 7);\n            ctx.strokeStyle = 'red';\n            ctx.stroke();\n        }\n    }\n}\n\nexport function draw_planet(ctx: CanvasRenderingContext2D, planet: Planet, cell_size: number, x?: number, y?: number) {\n    if (x === undefined) x = (planet.x) * cell_size;\n    if (y === undefined) y = (planet.y) * cell_size;\n    var grd = ctx.createRadialGradient(x - 1, y - 1, 2, x, y, planet_size * cell_size);\n    grd.addColorStop(0, planet.color_in);\n    grd.addColorStop(1, planet.color_out);\n    ctx.fillStyle = grd;\n    ctx.beginPath();\n    ctx.arc(x, y, planet_size * cell_size, 0, 7);\n    ctx.fill();\n}\n\n\nexport function draw_star(ctx: CanvasRenderingContext2D, star: Star) {\n    //calc_sizes(ctx, star);\n    const max_size = ctx.canvas.width;\n    const cell_size = max_size / (star.size);\n    const center = max_size / 2;\n    ctx.clearRect(0, 0, max_size, max_size);\n    if (star.bright) {\n        let grd = ctx.createRadialGradient(center, center, 0, center, center, cell_size / 2);\n        grd.addColorStop(0, \"white\");\n        grd.addColorStop(0.5, star.color);\n        grd.addColorStop(1, \"transparent\");\n        ctx.fillStyle = grd;\n        ctx.fillRect(0, 0, max_size, max_size);\n    } else {\n        let grd = ctx.createRadialGradient(center, center, 10, center, center, cell_size / 2);\n        grd.addColorStop(0, star.color);\n        grd.addColorStop(1, \"transparent\");\n        ctx.fillStyle = grd;\n        ctx.fillRect(0, 0, max_size, max_size);\n    }\n    for (let planet of star.planets) {\n        draw_planet(ctx, planet, cell_size);\n    }\n}\n\nexport function draw_ships(ctx: CanvasRenderingContext2D, ships: Ship[], myRadars: number) {\n    const max_size = ctx.canvas.width;\n    const cell_size = max_size / gs.star.size;\n    for (let ship of ships) {\n        if (ship instanceof PlayerShip || ship.seenBy(gs.playerShip, myRadars))\n            draw_ship(ctx, ship, cell_size);\n    }\n}\n\nexport function showDate(today: number) {\n    // console.log('showTime', now);\n    gebi('now-day').innerText = (today + 1).toString();\n    // const date = Math.floor(now);\n    const year = Math.floor(today / 300) + 3000;\n    const month = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov'][Math.floor((today % 300) / 30)];\n    const day = Math.floor(today % 30) + 1;\n    gebi('now-date').innerText = `${day} ${month} ${year}`;\n    // const time = now % 1;\n    // gebi('now-hr').innerText = Math.floor(time * 25);\n    // gebi('now-min').innerText = Math.round((time * 25 * 50) % 25);\n}\n\n// setInterval(showTime, 1000);", "import { showDate } from \"./draw\";\nimport { setStatus } from \"./index\";\nimport { PlayerShip } from \"./playerShip\";\nimport { Ship } from \"./ship\";\nimport { Star } from \"./stars\";\nimport { walkManager } from \"./walkManager\";\n\nexport class GameState {\n    star: Star;\n    playerShip: PlayerShip;\n    walkManager: walkManager;\n    walkCTX: CanvasRenderingContext2D;\n    now = 0;\n    lastTickTimestamp: number;\n    lastDate: number;\n    _timeFlies = false;\n    tickInterval = 0;\n\n    get timeFlies() { return this._timeFlies };\n    set timeFlies(value: boolean) {\n        // console.trace(value);\n        if (this._timeFlies == value) return;\n        this._timeFlies = value;\n        if (value) {\n            const t = this;\n            this.lastTickTimestamp = performance.now();\n            this.tickInterval = setInterval(function () { t.tick() }, 1000);\n        } else {\n            clearInterval(this.tickInterval);\n        }\n\n    };\n\n    tick(ts?: number): boolean {\n        if (!this._timeFlies) return false;\n        if (!ts) ts = performance.now();\n        if (ts <= this.lastTickTimestamp) return true;\n        this.now += Math.max(0, Math.min(ts - this.lastTickTimestamp, 1000)) / 1000;\n        this.lastTickTimestamp = ts;\n        const newDate = Math.floor(this.now);\n        if (this.lastDate != newDate) {\n            showDate(newDate);\n            this.lastDate = newDate;\n            const tripRemain = Math.ceil(this.playerShip.toTime - this.now);\n            setStatus(`Approaching ${this.playerShip.toPlanet.name} planet in ${tripRemain} days`);\n        }\n        for (let ship of this.star.ships) {\n            ship.updateSpaceXY(this.now);\n        }\n        return true;\n    };\n\n    depart() {\n        // console.log(this.playerShip);\n        // ship.fromPlanet = this;\n        // ship.toPlanet = dest;\n        // ship.fromTime = departTime;\n\n        // if (this.playerShip.onPlanet !== null) {\n        //     this.playerShip.fromPlanet = this.playerShip.onPlanet;\n        // }\n        this.timeFlies = true;\n        this.playerShip.flying = true;\n        this.playerShip.onPlanet = null;\n        this.walkManager.detach(this.walkCTX);\n        this.lastDate = -1;\n        this.tick();\n    }\n    arrive() {\n        this.playerShip.onPlanet = this.playerShip.toPlanet;\n        this.playerShip.x = this.playerShip.onPlanet.x;\n        this.playerShip.y = this.playerShip.onPlanet.y;\n        this.playerShip.flying = false;\n        this.timeFlies = false;\n        this.walkManager.attach(this.walkCTX, this.playerShip.onPlanet.base);\n        setStatus(`Docked to base at ${this.playerShip.onPlanet.name} planet`);\n\n    }\n}\n\nexport const gs = new GameState();\nshowDate(0);", "import { SaveableObject, addType } from './saveableType'\n\nexport abstract class Cargo extends SaveableObject { }\nexport function isCargoType(type: typeof SaveableObject): type is typeof Cargo { return type.prototype instanceof Cargo };\n\nexport abstract class UsefulCargo extends Cargo { }\n\nexport class Rocket extends UsefulCargo { }\naddType(Rocket, 'Rocket')\n\nexport class Fuel extends UsefulCargo { }\naddType(Fuel, 'Fuel')\n\nexport abstract class ResourceCargo extends Cargo { }\n\nexport class Water extends ResourceCargo {\n    static readonly color = 'blue';\n}\naddType(Water, 'Water')\n\nexport class Iron extends ResourceCargo {\n    static readonly color = 'yellow';\n}\naddType(Iron, 'Iron')\n\nexport class Food extends ResourceCargo {\n    static readonly color = 'green';\n}\naddType(Food, 'Food')\n\nexport class Radioactives extends ResourceCargo {\n    static readonly color = 'red';\n}\naddType(Radioactives, 'Radioactives')", "export function randomInt(a: number, b: number): number {\n\tif (a > b) [a, b] = [b, a];\n\treturn Math.floor(Math.random() * (b - a + 1)) + a;\n}\n\nexport function randomFrom<T>(a: T[]): T {\n\treturn a[Math.floor(Math.random() * a.length)];\n}\n\nexport function shuffle<T>(array: T[]): T[] {\n\treturn array.map((a: any) => ({ sort: Math.random(), value: a }))\n\t\t.sort((a: { sort: number; }, b: { sort: number; }) => a.sort - b.sort)\n\t\t.map((a: { value: any; }) => a.value)\n}\n\nexport function seq(a: number): number[] {\n\treturn [...Array(a).keys()]\n\t//=> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n}\n\nexport function sleep(ms: number) {\n\treturn new Promise(resolve => setTimeout(resolve, ms));\n}", "import { Cargo, UsefulCargo, isCargoType } from \"./cargo\"\nimport { Ballast, CargoBay, Cloak, Component, NavigationComputer, NormalComponent, Radar, TradingComputer, isCargoBay, isComponentType } from \"./components\"\nimport { cargoPerCargoBay, shipBaseSpeed, shipColors } from \"./const\"\nimport { Point } from \"./geometry\"\nimport { Planet } from \"./planets\"\nimport { fromJSON, types } from \"./saveableType\"\nimport { randomFrom, randomInt } from \"./utils\"\n\nexport interface xywh {\n    'x': number,\n    'y': number,\n    'w': number,\n    'h': number\n}\n\nexport class Ship {\n    color: string;\n    isAlien: boolean = false\n    rows: Array<Array<Component>> = []\n    offsets: Array<number> = []\n    componentTypes: { [typeName: string]: number }\n    cargoTypes: { [typeName: string]: number }\n    freeCargo: number\n    // next 4 are yet unused, to be used by detach/attach logic\n    isPlayerShip: boolean = false\n    playerOnShip: boolean = false\n    playerX: number\n    playerY: number\n    // position in space\n    x: number\n    y: number\n    fromPoint: Point\n    toPlanet: Planet\n    fromTime: number\n    toTime: number\n\n    updateSpaceXY(now: number, allowDispatch = true) {\n        while (now >= this.toTime && allowDispatch) {\n            this.toPlanet.dispatch(this, this.toTime);\n        }\n        const flightProgress = (now - this.fromTime) / (this.toTime - this.fromTime);\n        this.x = this.fromPoint.x + (this.toPlanet.x - this.fromPoint.x) * flightProgress;\n        this.y = this.fromPoint.y + (this.toPlanet.y - this.fromPoint.y) * flightProgress;\n    }\n\n    planTrip(fromPoint: Point, toPlanet: Planet, fromTime: number) {\n        this.fromPoint = fromPoint;\n        this.toPlanet = toPlanet;\n        this.fromTime = fromTime;\n        const dist = toPlanet.distanceTo(fromPoint);\n        const flyTime = dist / shipBaseSpeed;\n        this.toTime = fromTime + flyTime;\n        this.updateSpaceXY(this.fromTime);\n        // console.log('planTrip', fromTime, flyTime, dist, fromPlanet.name, toPlanet.name);\n    }\n\n    countComponents() {\n        this.componentTypes = {};\n        const x = Object.values(types).filter(isComponentType).forEach(\n            type => this.componentTypes[type.id] = 0);\n        const components = this.rows.flat();\n        for (let component of components) {\n            this.componentTypes[component.typename]++;\n        }\n    }\n\n    countCargo() {\n        const allCargoBays = this.rows.flat().filter(isCargoBay);\n        this.freeCargo = 0;\n        this.cargoTypes = {};\n        Object.values(types).filter(isCargoType).forEach(\n            type => this.cargoTypes[type.id] = 0);\n        for (let cargoBay of allCargoBays) {\n            this.freeCargo += cargoPerCargoBay - cargoBay.cargo.length;\n            for (let cargo of cargoBay.cargo) {\n                this.cargoTypes[cargo.typename]++;\n                // console.log(`countCargo found ${cargo.typename}, ${this.cargoTypes[cargo.typename]} at ${cargoBay.cellName}`)\n            }\n        }\n    }\n\n    getCargo(kind: typeof Cargo, amount: number) {\n        // NOTE: can't take more than we have\n        if (amount > this.cargoTypes[kind.id]) return false;\n        this.cargoTypes[kind.id] -= amount;\n        this.freeCargo += amount;\n        const allCargoBays = this.rows.flat().filter(isCargoBay).filter(cargoBay => cargoBay.cargo.length);\n        // TODO: sort\n        for (let cargoBay of allCargoBays) {\n            // filter out up to _amount_ items from cargo bays\n            // x=2;console.log([1,2,1,3,1,4,1,5].filter(v=>!(v==1&&x-->0)));\n            cargoBay.cargo = cargoBay.cargo.filter(cargo => !(cargo instanceof kind && amount-- > 0));\n            if (amount <= 0) return true;\n        }\n    }\n\n    putCargo(kind: typeof Cargo, amount: number) {\n        if (amount > this.freeCargo) return false;\n        this.cargoTypes[kind.id] += amount;\n        this.freeCargo -= amount;\n        const allCargoBays = this.rows.flat().filter(isCargoBay).filter(cargoBay => cargoBay.cargo.length < cargoPerCargoBay);\n        // TODO: sort\n        for (let cargoBay of allCargoBays) {\n            while (amount > 0 && cargoBay.cargo.length < cargoPerCargoBay) {\n                cargoBay.cargo.push(new (kind as unknown as new () => Cargo)());\n                amount--;\n            }\n            if (amount <= 0) return true;\n        }\n    }\n\n    seenBy(pos: Point, myRadars: number) {\n        const dist = Math.hypot(pos.x - this.x, pos.y - this.y);\n        return myRadars >= dist + this.componentTypes[Cloak.id];\n    }\n\n    toJSON() {\n        return {\n            'isAlien': this.isAlien,\n            'offsets': this.offsets,\n            'rows': this.rows.map(row => row.map(component => component.toJSON()))\n        }\n    }\n\n    static fromJSON(data: { isAlien: boolean; offsets: number[]; rows: { type: string }[][] }) {\n        const ship = new Ship()\n        ship.isAlien = data.isAlien\n        ship.offsets = data.offsets\n        ship.rows = data.rows.map(row => row.map((x: { type: string }) => fromJSON(x) as Component))\n        return ship;\n    }\n\n    // functions used in drawing\n    get gridSize() {\n        if (this.isAlien) {\n            // TODO\n            return {\n                'x0': 0,\n                'x1': 0,\n                'y0': 0,\n                'y1': 0,\n                'w': 0,\n                'h': 0\n            }\n        } else {\n            let max_pos = 0\n            let max_neg = 0\n            for (let i = 0; i < this.rows.length; i++) {\n                max_pos = Math.max(max_pos, this.rows[i].length - this.offsets[i])\n                max_neg = Math.max(max_neg, this.offsets[i])\n            }\n            return {\n                'x0': 0,\n                'x1': this.rows.length - 1,\n                'y0': max_pos,\n                'y1': max_neg,\n                'w': this.rows.length,\n                'h': max_pos + max_neg + 1\n            }\n        }\n    }\n    rowToXY(row: number, i: number) {\n        if (this.isAlien) {\n            // TODO\n            return {\n                'x': 0,\n                'y': 0\n            }\n        } else {\n            if (i >= this.offsets[row]) {\n                return {\n                    'x': row,\n                    'y': 1 + (i - this.offsets[row])\n                }\n            } else {\n                return {\n                    'x': row,\n                    'y': (i - this.offsets[row])\n                }\n            }\n        }\n    }\n    get passage(): xywh {\n        if (this.isAlien) {\n            // TODO\n            return {\n                'x': 0,\n                'y': 0,\n                'w': 0,\n                'h': 0\n            }\n        } else {\n            return {\n                'x': 0,\n                'y': 0,\n                'w': this.rows.length,\n                'h': 1\n            }\n        }\n    }\n    oppositeComponent(a: Component) {\n        for (let row = 0; row <= this.rows.length; row++) {\n            let i = this.rows[row].indexOf(a)\n            if (i >= 0) {\n                return this.rows[this.rows.length - 1 - row][i]\n            }\n        }\n    }\n\n    static randomShip(size: number, ship?: Ship) {\n        const rowCount = 4\n        const componentTypes = Object.values(types).filter(x => (x.prototype instanceof NormalComponent)) as Array<typeof Component>\n        const cargoTypes = Object.values(types).filter(x => (x.prototype instanceof Cargo)) as Array<typeof Cargo>\n        if (ship === undefined) ship = new Ship();\n        ship.color = randomFrom(shipColors);\n        ship.rows = [[], [], [], []]\n        ship.offsets = [0, 0, 0, 0]\n        for (let i = 0; i < size; i++) {\n            let row = randomInt(0, rowCount - 1)\n            let componentType = randomFrom(componentTypes) as unknown as new () => Component\n            let component = new componentType()\n            component.ship = ship;\n            if (component instanceof CargoBay) {\n                let cargos = randomInt(0, cargoPerCargoBay);\n                for (let j = 0; j < cargos; j++) {\n                    let cargoType = randomFrom(cargoTypes) as unknown as new () => Cargo\n                    component.cargo.push(new cargoType())\n                }\n            }\n            ship.rows[row].push(component)\n        }\n        for (let i = 0; i < ship.rows.length; i++) {\n            ship.offsets[i] = randomInt(0, ship.rows[i].length)\n        }\n        ship.balanceBallast()\n        ship.countComponents()\n        return ship\n    }\n\n    static newBase(planet: Planet) {\n        const ship = new Ship();\n        ship.color = 'black';\n        ship.rows = [[], []];\n        ship.rows[randomInt(0, 1)].push(new NavigationComputer())\n        ship.rows[randomInt(0, 1)].push(new Radar())\n        ship.rows[randomInt(0, 1)].push(new TradingComputer())\n        ship.offsets = [\n            randomInt(0, ship.rows[0].length),\n            randomInt(0, ship.rows[1].length)];\n        ship.balanceBallast()\n        ship.countComponents()\n        return ship\n    }\n\n    balanceBallast() {\n        if (this.isAlien) {\n            //...\n        } else {\n            const max = this.rows.length - 1\n            // balance offsets\n            for (var i = 0; i <= max; i++) {\n                while (this.offsets[i] < this.offsets[max - i]) {\n                    this.rows[i].unshift(new Ballast())\n                    this.offsets[i]++\n                }\n            }\n            // add ballast to balance \n            for (var i = 0; i <= max; i++) {\n                while (this.rows[i].length < this.rows[max - i].length) {\n                    this.rows[i].push(new Ballast())\n                }\n            }\n            // remove extra ballast from head\n            for (var i = 0; i <= max; i++) {\n                while (this.rows[i][0] instanceof Ballast\n                    && this.rows[max - i][0] instanceof Ballast) {\n                    this.rows[i].shift()\n                    this.rows[max - i].shift()\n                    this.offsets[i]--\n                    this.offsets[max - i]++\n                }\n            }\n            // remove extra ballast from tail\n            for (var i = 0; i <= max; i++) {\n                while (this.rows[i].at(-1) instanceof Ballast\n                    && this.rows[max - i].at(-1) instanceof Ballast) {\n                    this.rows[i].pop()\n                    this.rows[max - i].pop()\n                }\n            }\n            // TODO: remove empty rows?\n            // record what's opposite to ballast\n            for (var i = 0; i <= max; i++) {\n                for (var j = 0; j <= this.rows[i].length; j++) {\n                    if (this.rows[i][j] instanceof Ballast) {\n                        (this.rows[i][j] as Ballast).opposite = this.rows[max - i][j].typename\n                    }\n                }\n            }\n        }\n    }\n    get topAirlock() {\n        // returns x-coordinate \n        // NOTE: putTwoShips assumes that airlock location is always counted from left side,\n        // i.e. return value=0 means \"leftmost column\"\n        if (this.isAlien) {\n            // TODO\n            return 0;\n        } else {\n            let maxLen = 0\n            for (let i = 0; i < this.rows.length; i++) {\n                maxLen = Math.max(maxLen, this.rows[i].length - this.offsets[i])\n            }\n            for (let i = 0; i < this.rows.length; i++) {\n                if (this.rows[i].length - this.offsets[i] == maxLen)\n                    return i\n            }\n            return 0 // should never happen\n        }\n    }\n    get bottomAirlock() {\n        if (this.isAlien) {\n            // TODO\n            return 0;\n        } else {\n            const maxOffset = Math.max(...this.offsets);\n            return this.offsets.lastIndexOf(maxOffset);\n        }\n    }\n}", "import { gs } from \"./gameState\";\nimport { setStatus } from \"./index\";\nimport { Planet } from \"./planets\";\nimport { Ship } from \"./ship\";\n\n\nexport class PlayerShip extends Ship {\n    flying = false;\n    onPlanet: Planet | null;\n\n    updateSpaceXY(now: number) {\n        // console.log('updateSpaceXY', now, this.toTime);\n        super.updateSpaceXY(now, false);\n        if (now >= this.toTime) gs.arrive();\n    }\n\n    static randomShip(size: number): PlayerShip {\n        let ship = new PlayerShip();\n        Ship.randomShip(size, ship); //also fills in properties of the `ship` argument\n        ship.color = 'white';\n        return ship;\n    }\n}\n", "import { Component } from \"./components\"\nimport { componentSize } from \"./draw\"\nimport { Ship } from \"./ship\"\n\nclass WalkPoint {\n    canBeHere = false\n    canGoX = false\n    canGoY = false\n    ship?: Ship\n    component?: Component\n}\n\nexport class WalkMap {\n    map: Array<Array<WalkPoint>> = []\n    constructor(maxX: number, maxY: number) {\n        for (let x = 0; x <= maxX; x++) {\n            this.map[x] = []\n            for (let y = 0; y <= maxY; y++) {\n                this.map[x][y] = new WalkPoint()\n            }\n        }\n    }\n}\n\nexport class Walker {\n    x: number\n    y: number\n    map: WalkMap\n    box: HTMLElement\n    human: HTMLElement\n    canvas: HTMLCanvasElement\n    onEnter: (arg0?: Component) => void\n\n    goX(sign: number) {\n        if (!this.map.map[this.x][this.y].canGoX) return false;\n        if (!this.map.map[this.x + sign][this.y].canBeHere) return false;\n        this.x += sign\n        this.reposition()\n        this.onEnter(this.map.map[this.x][this.y].component)\n        return true\n    }\n    goY(sign: number, sure?: boolean) {\n        if (!sure && !this.map.map[this.x][this.y].canGoY) return false;\n        if (!this.map.map[this.x][this.y + sign].canBeHere) return false;\n        this.y += sign\n        this.reposition()\n        this.onEnter(this.map.map[this.x][this.y].component)\n        return true\n    }\n\n    goUp() { this.goY(-1); this.human.style.transform = 'rotate(0deg)' }\n    goDn(sure?: boolean) { this.goY(1, sure); this.human.style.transform = 'rotate(180deg)' }\n    goLt() { this.goX(-1); this.human.style.transform = 'rotate(-90deg)' }\n    goRt() { this.goX(1); this.human.style.transform = 'rotate(90deg)' }\n\n    jumpTo(x: number, y: number, callOnEnter = true) {\n        this.x = x;\n        this.y = y;\n        this.reposition(true);\n        if (callOnEnter) this.onEnter(this.map.map[x][y].component);\n    }\n\n    reposition(fast?: boolean) {\n        if (fast) {\n            this.canvas.classList.add('notransition');\n        }\n        let walkerOnCanvas_x = (this.x + 0.5) * componentSize\n        let walkerOnDiv_x = this.box.offsetWidth / 2\n        let canvasOffset_x = walkerOnDiv_x - walkerOnCanvas_x\n        this.canvas.style.left = canvasOffset_x + 'px'\n\n        let walkerOnCanvas_y = (this.y + 0.5) * componentSize\n        let walkerOnDiv_y = this.box.offsetHeight / 2\n        let canvasOffset_y = walkerOnDiv_y - walkerOnCanvas_y\n        this.canvas.style.top = canvasOffset_y + 'px'\n        if (fast) {\n            this.canvas.offsetHeight; // Trigger a reflow, flushing the CSS changes\n            this.canvas.classList.remove('notransition');\n        }\n    }\n}", "import { WalkMap, Walker } from \"./walker\";\nimport { Ship } from \"./ship\";\nimport { componentSize, drawShip, drawAirlock } from \"./draw\";\n\nexport class walkManager {\n    walker: Walker;\n    oneShipData: { x0: number; x1: number; y0: number; y1: number; w: number; h: number; };\n    twoShipsData: { ax0: number; ay0: number; airlock_x: number; airlock_y: number; bx0: number; by0: number; max_x: number; max_y: number; }\n    hasSecondShip = false;\n    myShip: Ship;\n    secondShip: Ship;\n\n    putTwoShips(a: Ship, b: Ship) {\n        const a_sz = a.gridSize;\n        const b_sz = b.gridSize;\n        const a_lock = a.bottomAirlock;\n        const b_lock = b.topAirlock;\n        const airlock_x = Math.max(a_lock, b_lock) + 1;\n        const airlock_y = a_sz.h + 1;\n        const max_x = airlock_x + Math.max(a_sz.w - a_lock, b_sz.w - b_lock);\n        const max_y = airlock_y + b_sz.h + 1;\n        this.myShip = b;\n        this.secondShip = a;\n        this.hasSecondShip = true;\n        this.twoShipsData = {\n            'ax0': airlock_x - a_lock + a_sz.x0,\n            'ay0': a_sz.y0 + 1,\n            'airlock_x': airlock_x,\n            'airlock_y': airlock_y,\n            'bx0': airlock_x - b_lock + b_sz.x0,\n            'by0': airlock_y + b_sz.y0 + 1,\n            'max_x': max_x,\n            'max_y': max_y,\n        };\n    }\n\n    drawTwoShips(ctx: CanvasRenderingContext2D, a: Ship, b: Ship) {\n        this.putTwoShips(a, b);\n        const c = this.twoShipsData;\n        //console.log('putTwoShips says', a.gridSize, b.gridSize, a.bottomAirlock, b.topAirlock, c)\n        const m = new WalkMap(c.max_x, c.max_y);\n        this.walker.map = m;\n        ctx.canvas.width = componentSize * (c.max_x + 1);\n        ctx.canvas.height = componentSize * (c.max_y + 1);\n\n        drawShip(ctx, c.ax0, c.ay0, a, m);\n        drawShip(ctx, c.bx0, c.by0, b, m);\n        drawAirlock(ctx, c.airlock_x, c.airlock_y, m);\n    }\n\n    drawMyShip(ctx: CanvasRenderingContext2D) {\n        this.hasSecondShip = false;\n        const gs = this.oneShipData = this.myShip.gridSize;\n        const m = this.walker.map = new WalkMap(gs.w + 1, gs.h + 1);\n        ctx.canvas.width = componentSize * (gs.w + 2);\n        ctx.canvas.height = componentSize * (gs.h + 2);\n        drawShip(ctx, gs.x0 + 1, gs.y0 + 1, this.myShip, m);\n    }\n\n    detach(ctx: CanvasRenderingContext2D) {\n        if (!this.hasSecondShip) return false;\n        let moveDnFromAirlock = false;\n        if (this.walker.y == this.twoShipsData.airlock_y) {\n            //player stands in airlock\n            // assume my ship is lower ship\n            this.walker.y++;\n            moveDnFromAirlock = true;\n        }\n        this.secondShip.playerOnShip = (this.walker.y < this.twoShipsData.airlock_y);\n        this.myShip.playerOnShip = (this.walker.y > this.twoShipsData.airlock_y);\n        if (this.walker.y < this.twoShipsData.airlock_y) {\n            // player on top (\"a\") ship\n            // TODO\n        } else {\n            // player on bottom (\"b\") ship, which is also my ship\n            const player_x = this.myShip.playerX = this.walker.x - this.twoShipsData.bx0;\n            const player_y = this.myShip.playerY = this.walker.y - this.twoShipsData.by0;\n            this.drawMyShip(ctx);\n            if (moveDnFromAirlock) {\n                this.walker.jumpTo(this.oneShipData.x0 + 1 + player_x, this.oneShipData.y0 + player_y, false);\n                this.walker.goDn(true);\n            } else {\n                this.walker.jumpTo(this.oneShipData.x0 + 1 + player_x, this.oneShipData.y0 + 1 + player_y, false);\n            }\n        }\n    }\n\n    attach(ctx: CanvasRenderingContext2D, otherShip: Ship) {\n        if (this.hasSecondShip) return false;\n        // player coordinates relative to ship\n        const player_x = this.walker.x - 1 - this.oneShipData.x0;\n        const player_y = this.walker.y - 1 - this.oneShipData.y0;\n        this.drawTwoShips(ctx, otherShip, this.myShip);\n        this.walker.jumpTo(this.twoShipsData.bx0 + player_x, this.twoShipsData.by0 + player_y);\n    }\n}\n", "type vector = [number, number];\n\nfunction normVector(x: number, y: number): vector {\n\tconst d = Math.hypot(x, y);\n\treturn [x / d, y / d];\n}\n\nfunction scalarMul(v1: vector, v2: vector): number {\n\treturn v1[0] * v2[0] + v1[1] * v2[1];\n}\n\nexport interface Point {\n\tx: number,\n\ty: number\n}\n\n// see http://www.gamedev.ru/code/forum/?id=74832 and https://ru.wikipedia.org/wiki/\u0420\u0430\u0441\u0441\u0442\u043E\u044F\u043D\u0438\u0435_\u043E\u0442_\u0442\u043E\u0447\u043A\u0438_\u0434\u043E_\u043F\u0440\u044F\u043C\u043E\u0439_\u043D\u0430_\u043F\u043B\u043E\u0441\u043A\u043E\u0441\u0442\u0438#\u041F\u0440\u044F\u043C\u0430\u044F_\u0437\u0430\u0434\u0430\u043D\u0430_\u0434\u0432\u0443\u043C\u044F_\u0442\u043E\u0447\u043A\u0430\u043C\u0438\nfunction dotOnLine(a: Point, b: Point, p: Point): vector {\n\tconst v = normVector(a.x - b.x, a.y - b.y);\n\tconst m = scalarMul(v, [p.x - b.x, p.y - b.y]);\n\treturn [b.x + v[0] * m, b.y + v[1] * m];\n}\n\n// does a-b line cross obj p with size?\nexport function lineCrossesObj(a: Point, b: Point, p: Point, size: number) {\n\tconst [x, y] = dotOnLine(a, b, p);\n\treturn x >= Math.min(a.x, b.x) &&\n\t\tx <= Math.max(a.x, b.x) &&\n\t\ty >= Math.min(a.y, b.y) &&\n\t\ty <= Math.max(a.y, b.y) &&\n\t\tMath.hypot(x - p.x, y - p.y) < size;\n}\n\n\n// see https://e-maxx.ru/algo/segments_intersection_checking\n\nfunction area(a: Point, b: Point, c: Point) {\n\treturn (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);\n}\n\nfunction intersect_1(a: number, b: number, c: number, d: number) {\n\tif (a > b) [a, b] = [b, a];\n\tif (c > d) [c, d] = [d, c];\n\treturn Math.max(a, c) <= Math.min(b, d);\n}\n\nexport function intersect(a: Point, b: Point, c: Point, d: Point) {\n\treturn intersect_1(a.x, b.x, c.x, d.x)\n\t\t&& intersect_1(a.y, b.y, c.y, d.y)\n\t\t&& area(a, b, c) * area(a, b, d) <= 0\n\t\t&& area(c, d, a) * area(c, d, b) <= 0;\n}\n", "import { Food, Iron, Radioactives, ResourceCargo, Water } from \"./cargo\";\nimport { shipBaseSpeed } from \"./const\";\nimport { Point } from \"./geometry\";\nimport { Ship } from \"./ship\";\nimport { shuffle, seq } from \"./utils\";\n\nexport type PlanetType = [name: string, buys: typeof ResourceCargo | null, sells: typeof ResourceCargo, color_in: string, color_out: string];\n\n//export const resources = ['water', 'iron', 'food', 'radioactives'];\nconst planetTypes = (function () {\n\tconst resources = [Water, Iron, Food, Radioactives];\n\t//var colors = ['blue', 'yellow', 'green', 'red'];\n\tvar planetNamesTable = [ // table: rows: what planet buys; columns: what planet sells; value: planet name\n\t\t[null, 'water-mining', 'farming', 'burning'],\n\t\t['ice', null, 'hunting', 'fire'],\n\t\t['fishy', 'bio-mining', null, 'nuclear'],\n\t\t['frozen', 'hot mining', 'ice-farming', null]];\n\n\tvar ret: PlanetType[] = [\n\t\t['ocean', null, Water, 'navy', 'blue'],\n\t\t//['dry', Water, null, 'blue', 'white'],\n\t\t//['mining', null, Iron, 'olive', 'yellow'],\n\t\t//['populated', Food, null, 'green', 'lime'],\n\t];\n\n\tfor (var buy = 0; buy < 4; buy++) {\n\t\tfor (var sell = 0; sell < 4; sell++) {\n\t\t\tif (buy == sell) continue;\n\t\t\tret.push([planetNamesTable[buy][sell] as string, resources[buy], resources[sell], resources[buy].color, resources[sell].color])\n\t\t}\n\t}\n\treturn ret;\n})();\n\nexport class Planet {\n\tx: number; y: number;\n\ttype: number;\n\tname: string;\n\tbuys: typeof ResourceCargo | null;\n\tsells: typeof ResourceCargo;\n\tratio: number; //how many 'sells' resource planet gives for 1 of 'buys' resource\n\tcolor_in: string;\n\tcolor_out: string;\n\tneighbours: Planet[];\n\tbase: Ship;\n\tconstructor(x: number, y: number, type_n: number) {\n\t\tvar type = planetTypes[type_n];\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.type = type_n;\n\t\tthis.name = type[0];\n\t\tthis.buys = type[1];\n\t\tthis.sells = type[2];\n\t\tthis.color_in = type[3];\n\t\tthis.color_out = type[4];\n\t\tthis.base = Ship.newBase(this);\n\t}\n\tdistanceTo(p: Point) {\n\t\treturn Math.hypot(this.x - p.x, this.y - p.y);\n\t}\n\tsave(): [number, number, number] {\n\t\treturn [this.x, this.y, this.type];\n\t}\n\tdispatch(ship: Ship, departTime: number) {\n\t\t//send the ship in a random direction\n\t\tconst dest = this.neighbours.shift() as Planet;\n\t\tthis.neighbours.push(dest);\n\t\tship.planTrip(this, dest, departTime);\n\t}\n}\n\nfunction isBad(x: number, y: number, size: number) {\n\tvar center = size / 2;\n\treturn x < center + 0.6 && x > center - 0.6 && y < center + 0.6 && y > center - 0.6;\n}\n\nexport function makePlanets(size: number) {\n\tvar thisPlanetTypes = shuffle(seq(planetTypes.length));\n\tfor (var _n = 0; _n < 100; _n++) {\n\t\tvar bad = false;\n\t\tvar ret: [number, number, number][] = [];\n\t\tvar xx = shuffle(seq(size));\n\t\tvar yy = shuffle(seq(size));\n\t\t// console.log(_n,xx,yy);\n\t\tvar center = size / 2;\n\t\tfor (var i = 0; i < size; i++) {\n\t\t\tif (isBad(xx[i] + 0.5, yy[i] + 0.5, size)) {\n\t\t\t\tbad = true;\n\t\t\t}\n\t\t\tret.push([xx[i] + 0.5, yy[i] + 0.5, thisPlanetTypes[i]]);\n\t\t}\n\t\tif (!bad) return ret;\n\t}\n\tconsole.error('should not be here');\n\treturn [];\n}\n", "import { ResourceCargo } from \"./cargo.js\";\nimport { planet_size, shipBaseSpeed } from \"./const.js\";\nimport { lineCrossesObj } from \"./geometry.js\";\nimport { makePlanets, Planet, PlanetType } from \"./planets.js\";\nimport { types } from \"./saveableType.js\";\nimport { Ship } from \"./ship.js\";\nimport { seq, randomFrom, randomInt, shuffle } from \"./utils.js\";\n\n// 1. copypaste table from https://www.cssportal.com/css3-color-names/ to vim\n// 2. :%s/^\\t\\([^\\t]*\\)\\t#[^\\t]*\\t/['\\1', /\n// 3. :%s/$/],/\n// 4. copypaste from vim to JS console, assign to var data=[...]\n// 5. use RGBToHSL function from https://css-tricks.com/converting-color-spaces-in-javascript/, modified to return only 'l' as number\n// 6. out=data.map(x=>[x[0],RGBToHSL(x[1],x[2],x[3])])\n// 7. prompt('',JSON.stringify(out.filter(x=>x[1]>40).map(x=>x[0])))\nvar starColors = [\"AliceBlue\", \"AntiqueWhite\", \"Aqua\", \"Aquamarine\", \"Azure\", \"Beige\", \"Bisque\", \"BlanchedAlmond\", \"Blue\", \"BlueViolet\", \"Brown\", \"BurlyWood\", \"CadetBlue\", \"Chartreuse\", \"Chocolate\", \"Coral\", \"CornflowerBlue\", \"Cornsilk\", \"Crimson\", \"Cyan\", \"DarkGray\", \"DarkGrey\", \"DarkKhaki\", \"DarkOrange\", \"DarkOrchid\", \"DarkSalmon\", \"DarkSeaGreen\", \"DarkTurquoise\", \"DarkViolet\", \"DeepPink\", \"DeepSkyBlue\", \"DimGray\", \"DodgerBlue\", \"FireBrick\", \"FloralWhite\", \"Fuchsia\", \"Gainsboro\", \"GhostWhite\", \"Gold\", \"Goldenrod\", \"Gray\", \"GreenYellow\", \"Grey\", \"Honeydew\", \"HotPink\", \"IndianRed\", \"Ivory\", \"Khaki\", \"Lavender\", \"LavenderBlush\", \"LawnGreen\", \"LemonChiffon\", \"LightBlue\", \"LightCoral\", \"LightCyan\", \"LightGoldenrodYellow\", \"LightGray\", \"LightGreen\", \"LightGrey\", \"LightPink\", \"LightSalmon\", \"LightSeaGreen\", \"LightSkyBlue\", \"LightSlateGray\", \"LightSlateGrey\", \"LightSteelBlue\", \"LightYellow\", \"Lime\", \"LimeGreen\", \"Linen\", \"Magenta\", \"MediumAquamarine\", \"MediumBlue\", \"MediumOrchid\", \"MediumPurple\", \"MediumSeaGreen\", \"MediumSlateBlue\", \"MediumSpringGreen\", \"MediumTurquoise\", \"MediumVioletRed\", \"MintCream\", \"MistyRose\", \"Moccasin\", \"NavajoWhite\", \"OldLace\", \"Orange\", \"OrangeRed\", \"Orchid\", \"PaleGoldenrod\", \"PaleGreen\", \"PaleTurquoise\", \"PaleVioletRed\", \"PapayaWhip\", \"PeachPuff\", \"Peru\", \"Pink\", \"Plum\", \"PowderBlue\", \"Red\", \"RosyBrown\", \"RoyalBlue\", \"Salmon\", \"SandyBrown\", \"Seashell\", \"Sienna\", \"Silver\", \"SkyBlue\", \"SlateBlue\", \"SlateGray\", \"SlateGrey\", \"Snow\", \"SpringGreen\", \"SteelBlue\", \"Tan\", \"Thistle\", \"Tomato\", \"Turquoise\", \"Violet\", \"Wheat\", \"White\", \"WhiteSmoke\", \"Yellow\", \"YellowGreen\"];\n\nfunction mkgrid(star: Star, size: number) {\n\tvar grid: (Star | undefined)[][] = seq(size).map(x => []);\n\tvar center = (size - 1) / 2;\n\tfor (var x = Math.floor(center); x <= Math.ceil(center); x++) {\n\t\tfor (var y = Math.floor(center); y <= Math.ceil(center); y++) {\n\t\t\tgrid[x + 1][y + 1] = star;\n\t\t}\n\t}\n\treturn grid;\n}\n\n// function countJobs(planets: Planet[]) {\n// \tvar data = { 'null': { buys: 0, sells: 0 } };\n// \tresources.forEach(x => { data[x] = { buys: 0, sells: 0 } });\n// \tplanets.forEach((planet: Planet) => { data[String(planet.buys)].buys++; data[String(planet.sells)].sells++ });\n// \tvar jobs = 0;\n// \tresources.forEach(x => { jobs += Math.min(data[x].buys, data[x].sells) });\n// \treturn jobs;\n// }\n\nexport interface StarData {\n\tc: string,\n\ts: number,\n\t// n: number[] | false,\n\tp: [number, number, number][] | false,\n\tv: boolean,\n}\n\nexport class Star {\n\tcolor: string;\n\tsize: number;\n\tvisited: boolean;\n\tx: number; y: number;\n\tbright: boolean;\n\tname: string;\n\t// neighbours: Directions;\n\tgrid: (Star | Planet | undefined)[][];\n\tplanets: Planet[];\n\tships: Ship[];\n\n\tconstructor(load?: StarData) {\n\t\tif (!load) {\n\t\t\tload = {\n\t\t\t\tc: randomFrom(starColors),\n\t\t\t\ts: randomInt(5, 9),\n\t\t\t\t// n: false,\n\t\t\t\tp: false,\n\t\t\t\tv: false,\n\t\t\t}\n\n\t\t}\n\t\t// TODO: make sure colors don't repeat\n\t\tthis.color = load.c;\n\t\tthis.size = load.s;\n\t\tthis.visited = load.v;\n\t\tthis.x = this.y = this.size / 2;\n\t\tthis.bright = false;\n\t\tthis.name = this.color;\n\t\tthis.ships = [];\n\t\tif (this.size % 2 == 0) {\n\t\t\tthis.bright = true;\n\t\t\tthis.name = 'bright ' + this.name;\n\t\t}\n\t\t// this.neighbours = new Directions(this);\n\t\t// if (load.n) {\n\t\t// \tfor (var value of load.n) {\n\t\t// \t\tthis.neighbours.add(new Direction(value, this));\n\t\t// \t}\n\t\t// }\n\t\tthis.grid = mkgrid(this, this.size);\n\t\tif (!load.p) load.p = makePlanets(this.size); //from planets.js\n\t\tthis.planets = load.p.map((x) => new Planet(...x));\n\t\tfor (var planet of this.planets) {\n\t\t\t// add neighbours\n\t\t\tplanet.neighbours = shuffle(this.planets.filter(p => p != planet && !this.pathCollides(p, planet)));\n\t\t\t// add planet to grid\n\t\t\tthis.grid[Math.floor(planet.x)][Math.floor(planet.y)] = planet;\n\t\t}\n\t\t// this.jobs = countJobs(this.planets);\n\t\tthis.setRatios();\n\t}\n\n\t// link(other: Star, direction: number | Direction) {\n\t// \tif (direction instanceof Direction) {\n\t// \t\tdirection.target = other;\n\t// \t\tother.neighbours.link(direction.value + 180, this);\n\t// \t} else {\n\t// \t\tthis.neighbours.link(direction, other);\n\t// \t\tother.neighbours.link(direction + 180, this);\n\t// \t}\n\t// }\n\n\tpathCollides(a: Planet, b: Planet): boolean {\n\t\tif (lineCrossesObj(a, b, this, 0.5)) return true;\n\t\tfor (var planet of this.planets) {\n\t\t\tif (planet != a && planet != b &&\n\t\t\t\tlineCrossesObj(a, b, planet, planet_size)) return true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tcomputeRareResources(planets?: Planet[]) {\n\t\tif (planets === undefined) planets = this.planets;\n\t\tconst producedResources = planets.map(planet => planet.sells);\n\t\tconst rareResources = Object.values(types).filter(resource => resource instanceof ResourceCargo && !producedResources.includes(resource)) as (typeof ResourceCargo)[];\n\t\tconst abundantResources = planets.filter(planet => planet.buys === null).map(planet => planet.sells) as (typeof ResourceCargo)[];\n\t\treturn {\n\t\t\t'exotic': rareResources,\n\t\t\t'abundant': abundantResources\n\t\t}\n\t}\n\n\tsetRatios() {\n\t\tconst ar = this.computeRareResources();\n\t\tfor (let planet of this.planets) {\n\t\t\tif (planet.buys === null) planet.ratio = 2; //gives for free\n\t\t\telse if (ar.abundant.includes(planet.buys)) planet.ratio = 1;\n\t\t\telse if (ar.exotic.includes(planet.buys)) planet.ratio = 2;\n\t\t\telse planet.ratio = 1.4;\n\t\t}\n\t}\n\n\taddRandomShips(now: number) {\n\t\tthis.ships = [];\n\t\tfor (let i = 0; i < this.planets.length; i++) {\n\t\t\tfor (let j = 0; j < i; j++) {\n\t\t\t\tif (this.planets[i].neighbours.indexOf(this.planets[j]) < 0) continue;\n\t\t\t\tlet s = Ship.randomShip(15);\n\t\t\t\tconst dist = Math.hypot(this.planets[i].x - this.planets[j].x, this.planets[i].y - this.planets[j].y);\n\t\t\t\tconst flyTime = dist / shipBaseSpeed;\n\t\t\t\tthis.planets[i].dispatch(s, now - flyTime);\n\t\t\t\tthis.ships.push(s);\n\t\t\t}\n\t\t}\n\t}\n\n\tsave(): StarData {\n\t\treturn {\n\t\t\tc: this.color,\n\t\t\ts: this.size,\n\t\t\t// n: Array.from(this.neighbours).map(x => x.value),\n\t\t\tp: this.planets.map(x => x.save()),\n\t\t\tv: this.visited,\n\t\t};\n\t}\n}\n\n", "//import { } from \"./draw.js\";\nimport { PlayerShip } from \"./playerShip.js\";\nimport { Ship } from \"./ship.js\";\nimport { CargoBay, Component } from \"./components.js\";\nimport { fromJSON, types } from \"./saveableType.js\";\nimport { Rocket } from \"./cargo.js\";\nimport { componentSize, drawShip } from \"./draw.js\";\nimport { walkManager } from \"./walkManager.js\";\nimport { WalkMap, Walker } from \"./walker.js\";\nimport { Star } from \"./stars.js\";\nimport { gs } from \"./gameState.js\";\n\nexport function gebi(id: string) {\n    const element = document.getElementById(id);\n    if (!element) throw ReferenceError(`element ${id} not found`);\n    return element;\n}\nexport function gibi(id: string) {\n    const element = gebi(id);\n    if (!(element instanceof HTMLInputElement)) throw ReferenceError(`element ${id} is not input`);\n    return element;\n}\n\nif (location.hostname == 'localhost' || location.hostname == '127.0.0.1') {\n    new EventSource('/esbuild').addEventListener('change', () => location.reload());\n}\n\n\n\nlet my_ship = PlayerShip.randomShip(15);\n// let my_ship = Ship.randomShip(15);\n// let other_ship = Ship.randomShip(35);\n\nwindow.gs = gs;\n\ngs.star = new Star();\ngs.star.addRandomShips(0);\ngs.star.ships.push(my_ship);\ngs.playerShip = my_ship;\n\n//var s = Ship.randomShip(1);\n//var m = new WalkMap(0, 0)\nvar w = new Walker()\nvar wm = new walkManager()\nwm.walker = w;\ngs.walkManager = wm;\n\nvar c = gebi(\"myCanvas\") as HTMLCanvasElement;\nvar ctx = c.getContext(\"2d\") as CanvasRenderingContext2D;\n\nw.box = gebi('canvasBox')\nw.human = gebi('human')\nw.canvas = c\nw.onEnter = onEnter\ngs.walkCTX = ctx;\n\nfunction x_rand() {\n    wm.myShip = my_ship;\n    wm.drawMyShip(ctx);\n    w.jumpTo(wm.oneShipData.x0 + 1, wm.oneShipData.y0 + 1);\n    my_ship.planTrip({ 'x': gs.star.planets[0].x - 0.1, y: gs.star.planets[0].y }, gs.star.planets[0], -1);\n    gs.now = 0;\n    gs.arrive();\n}\n\n// function x_attach() {\n//     wm.attach(ctx, Ship.randomShip(25));\n//     setStatus('Docked to another ship');\n// }\n\n// function x_save() {\n//     localStorage.space2d3_1_ship = JSON.stringify(s.toJSON())\n// }\n\n// function x_load() {\n//     s = Ship.fromJSON(JSON.parse(localStorage.space2d3_1_ship))\n//     x_draw(s)\n// }\n\nx_rand();\n// gebi('save').onclick = x_save;\n// gebi('load').onclick = x_load;\n// gebi('random').onclick = x_rand;\n\nwindow.onkeypress = (e) => {\n    switch (e.key) {\n        case 'w': w.goUp(); break;\n        case 'a': w.goLt(); break;\n        case 's': w.goDn(); break;\n        case 'd': w.goRt(); break;\n    }\n}\n\nfunction onEnter(c?: Component) {\n    if (!c) return;\n    gebi('currentComponent').innerHTML = `#${c.typename} {display:block}`\n    if (c.cellName)\n        gebi('componentLegend').innerText = `${c.cellName}: ${c.typename}`\n    else\n        gebi('componentLegend').innerText = `${c.typename}`\n    c.onEnter(gs)\n}\n\nexport function setStatus(s: string) {\n    gebi('status').innerText = s;\n}\n"],
  "mappings": "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",
  "names": ["shipColors", "SaveableObject", "type", "data", "fromJSON", "types", "addType", "id", "Component", "SaveableObject", "gs", "isComponentType", "type", "UselessComponent", "Airlock", "gebi", "addType", "Passage", "Ballast", "Debris", "_Debris", "data", "a", "NormalComponent", "CargoBay", "_CargoBay", "x", "fromJSON", "isCargoBay", "component", "Radar", "ctx", "drawRadar", "ts", "c", "draw_star", "draw_ships", "Cloak", "ComputerComponent", "NormalComponent", "NavigationComputer", "value", "planet", "i", "gs", "time", "selected", "id", "gebi", "p", "a", "b", "c", "ctx", "draw_planet", "PlayerShip", "el", "addType", "TradingComputer", "giftAmount", "slider", "giveAmount", "getAmount", "componentSize", "componentOffset", "drawComponent", "ctx", "x", "y", "ship", "component", "map", "componentTitle", "ComputerComponent", "Cloak", "drawPassage", "x0", "y0", "p", "Passage", "drawAirlock", "Airlock", "drawShip", "row", "i", "xy", "draw_ship", "cell_size", "PlayerShip", "r", "draw_planet", "planet", "grd", "draw_star", "star", "max_size", "center", "draw_ships", "ships", "myRadars", "gs", "showDate", "today", "gebi", "year", "month", "day", "GameState", "value", "ts", "newDate", "showDate", "tripRemain", "setStatus", "ship", "gs", "Cargo", "SaveableObject", "isCargoType", "type", "UsefulCargo", "Rocket", "addType", "Fuel", "ResourceCargo", "Water", "Iron", "Food", "Radioactives", "randomInt", "a", "b", "randomFrom", "shuffle", "array", "seq", "Ship", "_Ship", "now", "allowDispatch", "flightProgress", "fromPoint", "toPlanet", "fromTime", "flyTime", "x", "types", "isComponentType", "type", "components", "component", "allCargoBays", "isCargoBay", "isCargoType", "cargoBay", "cargo", "kind", "amount", "pos", "myRadars", "dist", "Cloak", "row", "data", "ship", "fromJSON", "max_pos", "max_neg", "i", "a", "size", "componentTypes", "NormalComponent", "cargoTypes", "Cargo", "randomFrom", "shipColors", "randomInt", "componentType", "CargoBay", "cargos", "j", "cargoType", "planet", "NavigationComputer", "Radar", "TradingComputer", "max", "Ballast", "maxLen", "maxOffset", "PlayerShip", "_PlayerShip", "Ship", "now", "gs", "size", "ship", "WalkPoint", "WalkMap", "maxX", "maxY", "x", "y", "Walker", "sign", "sure", "callOnEnter", "fast", "walkerOnCanvas_x", "componentSize", "canvasOffset_x", "walkerOnCanvas_y", "canvasOffset_y", "walkManager", "a", "b", "a_sz", "b_sz", "a_lock", "b_lock", "airlock_x", "airlock_y", "max_x", "max_y", "ctx", "c", "m", "WalkMap", "componentSize", "drawShip", "drawAirlock", "gs", "moveDnFromAirlock", "player_x", "player_y", "otherShip", "normVector", "x", "y", "d", "scalarMul", "v1", "v2", "dotOnLine", "a", "b", "p", "v", "m", "lineCrossesObj", "size", "planetTypes", "resources", "Water", "Iron", "Food", "Radioactives", "planetNamesTable", "ret", "buy", "sell", "Planet", "x", "y", "type_n", "type", "Ship", "p", "ship", "departTime", "dest", "isBad", "size", "center", "makePlanets", "thisPlanetTypes", "shuffle", "seq", "_n", "bad", "xx", "yy", "i", "starColors", "mkgrid", "star", "size", "grid", "seq", "x", "center", "y", "Star", "load", "randomFrom", "randomInt", "makePlanets", "Planet", "planet", "shuffle", "p", "a", "b", "lineCrossesObj", "planets", "producedResources", "rareResources", "types", "resource", "ResourceCargo", "abundantResources", "ar", "now", "i", "j", "s", "Ship", "flyTime", "gebi", "id", "element", "gibi", "my_ship", "PlayerShip", "gs", "Star", "w", "Walker", "wm", "walkManager", "c", "ctx", "onEnter", "x_rand", "e", "setStatus", "s"]
}
