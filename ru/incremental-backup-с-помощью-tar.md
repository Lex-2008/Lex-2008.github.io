title=Incremental backup с помощью TAR
intro=Как настроить автоматическую архивацию так, чтобы она занимала минимум времени
tags=ссылки linux
created=2014-02-12
modified=2015-10-03
modified_now=1


На сайте [alex-at.ru](http://alex-at.ru/linux/tar-linux) подробно рассказано, как настроить инкрементальную архивацию с помощью TAR.

Краткий конспект:

Запускать `tar` с таким набором параметров:

    /bin/tar --create --ignore-failed-read --one-file-system --preserve-permissions --recursion --preserve-order --sparse --totals --wildcards --verbose --gzip --file=файл_бэкапа --listed-incremental=файл_метаданных --exclude-from=файл_исключений путь_который_бэкапим

При этом файл\_метаданных обновляется (что, может быть, нежелательно). Поэтому держим файл\_метаданных, соответствующий каждому созданному архиву, и при создании нового архива **делаем копию** и указываем путь того файла\_метаданных, на основе "чьего" архива хотим создать текущий.

Тогда можно сделать приколы типа:

> делать полный бэкап каждый месяц, каждую неделю делать разность от ежемесячного бэкапа, а каждый день - от прошлого дня

Более подробно об этом - [в моем англоязычном блоге](/en/incremental-backups.html)
